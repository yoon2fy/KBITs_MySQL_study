# SQL 기본

## 📚 SQL의 분류
### 📖 DML (Data Manipulation Language, 데이터 조작 언어)
- 데이터를 조작 선택 , 삽입 , 수정 , 삭제 하는 데 사용되는 언어
- DML 구문이 사용되는 대상은 테이블의 행
- DML 사용하기 위해서는 테이블이 정의되어 있어야 함
- **SELECT, INSERT, UPDATE, DELETE**
- **트랜잭션 (Transcation)**  발생 ➞ 테이블의 데이터를 변경 입력 수정 삭제 할 때 실제 테이블에 완전히 적용하지 않고, 임시로 적용시키는 것 (취소 가능)

### 📖 DCL (Data Control Language, 데이터 제어 언어)
- 사용자에게 어떤 권한을 부여하거나 빼앗을 때 주로 사용하는 구문
- **GRANT/REVOKE/DENY**

---

## 데이터 변경을 위한 SQL 문
## 📚 데이터의 삽입: INSERT
```sql  
INSERT INTO 테이블이름(열 이름1, 열 이름2, ...)
SELECT 문;
```

### 📑 자동으로 증가하는 AUTO_INCREMENT
- INSERT 에서는 해당 열이 없다고 생각하고 입력
- INSERT 문에서 NULL 값 지정하면 자동으로 값 입력
- 1부터 증가하는 값 자동 입력
- 적용할 열이 `PRIMARY KEY` 또는 `UNIQUE` 일 때만 사용가능
- 데이터 형은 숫자 형식만 사용 가능

### 📑 INSERT IGNORE 문
- 에러 발생해도 다음 구문으로 넘어가게 처리
- 에러 메시지 보면 적용되지 않은 구문이 어느 것인지 구분 가능

## 📚 데이터의 수정: UPDATE
- 기존의 입력되어 있는 값 변경하는 구문

```sql
UPDATE 테이블이름
SET 열1=값1, 열2=값2, ...
WHERE 조건;
```

### 📑 ON DUPLICATE KEY UPDATE 구문
- 기본 키가 중복되면 데이터를 수정되도록 하는 구문도 활용 가능

## 📚 데이터의 삭제: DELETE
- 행 단위로 데이터를 삭제하는 구문
- LIMIT으로 삭제건 수 지정 가능

```sql
DELETE FROM 테이블이름
WHERE 조건;
```

### 📑 테이블을 삭제하는 경우의 속도 비교
- DML문인 `DELETE`는 트랜잭션 로그 기록 작업 때문에 삭제 느림
- DDL문인 `DROP`과 `TRUNCATE`문은 트랜잭션 없어 빠름
- 테이블 자체가 필요 없을 경우에는 `DROP`으로 삭제
- 테이블의 구조는 남겨놓고 싶다면 `TRUNCATE`로 삭제하는 것이 효율적

---

## 📚 USE 구문
- SELECT문 학습을 위해 사용할 데이터 베이스를 지정함.

```sql
USE 데이터베이스_이름;
```

## 📚 SELECT 구문
- 테이블에서 필요로 하는 열만 가져오기 가능
- 여러 개의 열을 가져오고 싶을 때는 콤마로 구분
- 열 이름의 순서는 출력하고 싶은 순서대로 배열 가능

### 📑 DB, TABLE, COLUMN의 이름이 확실하지 않을 때 조회하는 방법

```sql
-- 현재 서버에 어떤 DB가 있는지 보는법
SHOW DATABASES;

-- 현재 서버에 어떤 TABLE이 있는지 보는법
SHOW TABLES;

-- 현재 테이블의 열이 무엇이 있는지 확인하는 법
DESCRIBE 테이블이름;
```

---

## 📚 특정 조건의 데이터만 조회하는 법 <SELECT ... FROM ... WHERE>
### 📑 조건 연산자와 관계 연산자의 사용

|조건 연산자|관계 연산자|
|-|-|
|=, <, >, <=, >=, <>, !=|NOT, AND, OR|

### 📑 BETWEEN ... AND
- 데이터가 숫자로 구성되어 있으며, 연속적인 값인 경우

### 📑 IN ( )
- 이산적인(Discrete) 값의 조건인 경우

### 📑 LIKE
- 문자열의 내용을 검색하는 경우
- `%`: 무엇이든 허용함
- `_`: 한 글자만 허용함

### 📑 서브 쿼리(Sub Query, 하위쿼리)
- 쿼리문 안에 또 쿼리문이 들어 있는 것

### 📑 ANY (서브쿼리)
- 서브쿼리의 여러 개의 결과 중 **한 가지만** 만족해도 가능
- SOME 은 ANY 와 동일한 의미로 사용
- `=ANY(서브쿼리)` 는 `IN(서브쿼리)`와 동일한 의미

### 📑 ALL (서브쿼리)
- 서브쿼리의 결과 중 여러 개의 결과를 **모두** 만족해야 함

---

## 📚 원하는 순서대로 정렬하여 출력: ORDER BY
- 결과물에 대해 영향을 미치지는 않고 출력되는 순서를 조절하는 구문
- 오름차순: ASC
- 내림차순: DESC

## 📚 중복된 것은 하나만 남기는 DISTINCT
- 중복된 것을 골라서 세기 어려울 때 사용하는 구문
- 테이블의 크기가 클 수록 효율적임
- 중복된 것은 **1개씩만** 보여주며 출력

---

## 📚 출력하는 개수를 제한하는 LIMIT
- 일부를 보기 위해 여러 건의 데이터를 출력하는 부담을 줄임
- 상위 N개만 출력하는 `LIMIT N` 구문을 사용
- 개수의 문제 보다는 MySQL의 부담을 많이 줄여주는 방법

### 📑 페이지네이션
```sql
LIMIT 시작, 개수;

LIMIT 개수 OFFSET 시작;
```

---

## 📚 테이블을 복사하는 CREATE TABLE ... SELECT
- 테이블을 복사해서 사용할 경우 주로 사용
- PK나 FK같은 제약 조건은 복사되지 않음

```sql
CREATE TABLE 새테이블(
  SELECT *
  FROM 기존테이블
);
```

---

## 📚 GROUP BY, HAVING, 그리고 집계함수
### 📑 GROUP BY 절
- 그룹으로 묶어주는 역할
- 집계 함수(Aggregate Function)와 함께 사용
- 효율적인 데이터 그룹화(Grouping)

### 📑 HAVING
- WHERE 와 비슷한 개념으로 조건 제한하는 것이지만, 집계 함수에 대해서 조건을 제한하는 것
- HAVING 절은 꼭 GROUP BY절 다음에 나와야 함 순서 바뀌면 안됨

### 📑 ROLLUP
- 총합 또는 중간 합계가 필요할 경우 사용
- GROUP BY 절과 함께 `WITH ROLLUP` 문 사용

### 📑 집계함수

|함수명|설명|
|-|-|
|AVG()|평균을 구함|
|MIN()|최소값을 구함|
|MAX()|최대값을 구함|
|COUNT()|행의 개수를 셈|
|COUNT(DISTINCT())|행의 개수를 셈 (중복은 1개만 인정)|
|STDEV()|표준편차를 구함|
|VAR_SAMP()|분산을 구함|
